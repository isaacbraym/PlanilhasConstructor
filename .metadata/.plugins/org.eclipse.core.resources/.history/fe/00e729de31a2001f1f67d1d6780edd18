import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

public class TestePlanilha {
    public static void main(String[] args) {
        IPlanilha planilha = new PlanilhaXlsx();

        String diretorioSaida = "C:\\opt\\tmp\\testePlanilhaSaidas";
        planilha.setDiretorioSaida(diretorioSaida);

        try {
            Files.createDirectories(Paths.get(planilha.getDiretorioSaida()));
        } catch (IOException e) {
            System.out.println("Erro ao criar diretório: " + e.getMessage());
            return;
        }

        String timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        String nomeArquivoPlanilha = "\\planilhaTeste_" + timestamp + ".xlsx";
        String caminhoArquivo = planilha.getDiretorioSaida() + nomeArquivoPlanilha;
        String listaDeArquivos = "C:\\opt\\lista_dados_brasileiros.txt";

        // Criação da planilha
        planilha.criarPlanilha("Dados Brasileiros");
        planilha.aplicarEstilo().removerLinhasDeGrade();

        // Inserção do cabeçalho com bordas
        String header = "NOME,CPF/CNPJ,ENDERECO,NUMERO,COMPLEMENTO,CEP,CIDADE,ESTADO,VALOR";
        List<String> headerList = Arrays.asList(header.split(","));
        planilha.gravarDadoNaCelula("B2")
                .inserirDadosLinha(headerList)
                .aplicarEstilos()
                .centralizarBold()
                .aplicarTodasAsBordas(); // Aplicação de bordas ao cabeçalho

        // Inserção dos dados do arquivo com bordas
        planilha.gravarDadoNaCelula("B3")
                .inserirDadosArquivo(listaDeArquivos)
                .aplicarEstilos()
                .aplicarTodasAsBordas(); // Aplicação de bordas nas linhas de dados

        // Conversão de valores para numérico e soma
        planilha.converterEmNumero("J3")
                .somarColunaComTexto("J3", "TOTAL DA SOMA");

        // Aplicação de estilos nas colunas I e J
        // Aplicar negrito à última célula da coluna I
        planilha.aplicarBoldUltimaLinha("I");
        int ultimaLinhaI = planilha.obterUltimaLinhaDaColuna("I");
        if (ultimaLinhaI != -1) {
            String posicaoI = "I" + (ultimaLinhaI + 1); // +1 para converter de 0-based para 1-based
            planilha.aplicarEstilo().aplicarBordaNaCelula(posicaoI);
        }

        // Aplicar negrito à última célula da coluna J
        planilha.aplicarBoldUltimaLinha("J");
        int ultimaLinhaJ = planilha.obterUltimaLinhaDaColuna("J");
        if (ultimaLinhaJ != -1) {
            String posicaoJ = "J" + (ultimaLinhaJ + 1); // +1 para converter de 0-based para 1-based
            planilha.aplicarEstilo().aplicarBordaNaCelula(posicaoJ);
        }

        // Aplicar centralização e redimensionamento a toda a planilha
        planilha.aplicarEstilo()
                .centralizarERedimensionarTudo();

        // Salva a planilha
        try {
            planilha.salvar(caminhoArquivo);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
