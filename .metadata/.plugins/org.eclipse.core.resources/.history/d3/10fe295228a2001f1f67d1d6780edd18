import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

public class TestePlanilha {
	public static void main(String[] args) {
		IPlanilha planilha = new PlanilhaXlsx();

		String diretorioSaida = "C:\\opt\\tmp\\testePlanilhaSaidas";
		planilha.setDiretorioSaida(diretorioSaida);

		try {
			Files.createDirectories(Paths.get(planilha.getDiretorioSaida()));
		} catch (IOException e) {
			System.out.println("Erro ao criar diret√≥rio: " + e.getMessage());
			return;
		}

		String timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
		String nomeArquivoPlanilha = "\\planilhaTeste_" + timestamp + ".xlsx";
		String caminhoArquivo = planilha.getDiretorioSaida() + nomeArquivoPlanilha;
		String listaDeArquivos = "C:\\opt\\lista_dados_brasileiros.txt";

		planilha.criarPlanilha("Dados Brasileiros");
		planilha.aplicarEstilo().removerLinhasDeGrade();

		String header = "NOME,CPF/CNPJ,ENDERECO,NUMERO,COMPLEMENTO,CEP,CIDADE,ESTADO,VALOR";
		List<String> headerList = Arrays.asList(header.split(","));
		planilha.gravarDadoNaCelula("B2").inserirDadosLinha(headerList);

		planilha.aplicarEstilo().BoldStyle().inserirEmLinha("B2", "J2");

		planilha.gravarDadoNaCelula("B3").inserirDadosArquivo(listaDeArquivos);

		planilha.converterEmNumero("J3");
		planilha.somarColunaComTexto("J3", "TOTAL SOMA");

		planilha.aplicarEstilo().redimensionarColunas().centralizarTudo();
		planilha.aplicarBoldUltimaLinha("I");
		planilha.aplicarBoldUltimaLinha("J");

		try {
			planilha.salvar(caminhoArquivo);
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
