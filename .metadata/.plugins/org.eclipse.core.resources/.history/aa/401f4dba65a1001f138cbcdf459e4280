import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellStyle;
import org.apache.poi.ss.usermodel.Font;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.*;

public class EstiloCelula {
    private final Workbook workbook;
    private final Sheet sheet;
    private final CellStyle boldStyle;

    public EstiloCelula(Workbook workbook, Sheet sheet) {
        this.workbook = workbook;
        this.sheet = sheet;
        Font font = workbook.createFont();
        font.setBold(true);

        boldStyle = workbook.createCellStyle();
        boldStyle.setFont(font);
    }

    // Aplica o estilo a uma coluna inteira a partir de uma linha específica
    public EstiloCelula coluna(int numeroColuna, int linhaInicial) {
        for (int i = linhaInicial; i <= sheet.getLastRowNum(); i++) {
            Row row = sheet.getRow(i);
            if (row == null) {
                row = sheet.createRow(i);
            }
            Cell cell = row.getCell(numeroColuna);
            if (cell == null) {
                cell = row.createCell(numeroColuna);
            }
            cell.setCellStyle(boldStyle);
        }
        return this;
    }

    // Aplica o estilo em uma faixa específica de linhas em uma coluna específica
    public EstiloCelula linhaDeAte(int numeroColuna, int linhaInicial, int linhaFinal) {
        for (int i = linhaInicial; i <= linhaFinal; i++) {
            Row row = sheet.getRow(i);
            if (row == null) {
                row = sheet.createRow(i);
            }
            Cell cell = row.getCell(numeroColuna);
            if (cell == null) {
                cell = row.createCell(numeroColuna);
            }
            cell.setCellStyle(boldStyle);
        }
        return this;
    }

    // Aplica o estilo em uma área retangular (matriz)
    public EstiloCelula matriz(int colunaInicial, int linhaInicial, int colunaFinal, int linhaFinal) {
        for (int i = linhaInicial; i <= linhaFinal; i++) {
            Row row = sheet.getRow(i);
            if (row == null) {
                row = sheet.createRow(i);
            }
            for (int j = colunaInicial; j <= colunaFinal; j++) {
                Cell cell = row.getCell(j);
                if (cell == null) {
                    cell = row.createCell(j);
                }
                cell.setCellStyle(boldStyle);
            }
        }
        return this;
    }
}
